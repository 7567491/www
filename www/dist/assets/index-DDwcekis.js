import{d as N,r as v,c as m,a as F,b as u,e as o,f as k,w as V,v as U,t as h,F as A,g as E,o as d,h as D,i as R,j as I,k as O,l as K,m as P,n as Q,p as Z,q as j,s as W,u as q,R as G,x as H,y as J}from"./vendor-CD0kCKB7.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const p of i.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&r(p)}).observe(document,{childList:!0,subtree:!0});function n(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(t){if(t.ep)return;t.ep=!0;const i=n(t);fetch(t.href,i)}})();class Y{accessKey;secretKey;region;endpoint;bucket;constructor(){this.accessKey="BBI7VFBNRQLZYIHRVE4J",this.secretKey="Oqis1uk2hdGKeE6EQ0fdcRz9u9hlIylmZF8ZBxJg",this.region="ap-south-1",this.endpoint="https://ap-south-1.linodeobjects.com",this.bucket="www"}async generatePresignedUrl(e=""){return new Date().toISOString().replace(/[:-]|\.\d{3}/g,"").substr(0,8),`${this.endpoint}/${this.bucket}/${e}`}async listFiles(e="",n=100){try{const r=[{key:"index.html",lastModified:"2024-01-15T10:30:00Z",size:2048,etag:"abc123",storageClass:"STANDARD",url:`${this.endpoint}/${this.bucket}/index.html`,type:"file"},{key:"assets/",lastModified:"2024-01-15T09:00:00Z",size:0,etag:"",storageClass:"STANDARD",url:`${this.endpoint}/${this.bucket}/assets/`,type:"folder"},{key:"images/logo.png",lastModified:"2024-01-14T15:20:00Z",size:15432,etag:"def456",storageClass:"STANDARD",url:`${this.endpoint}/${this.bucket}/images/logo.png`,type:"file"}],t=e?r.filter(i=>i.key.startsWith(e)):r;return{files:t,totalCount:t.length,hasMore:!1}}catch(r){throw console.error("获取文件列表失败:",r),new Error("无法获取存储桶文件列表")}}getFileUrl(e){return`${this.endpoint}/${this.bucket}/${e}`}formatFileSize(e){if(e===0)return"0 B";const n=1024,r=["B","KB","MB","GB"],t=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,t)).toFixed(2))+" "+r[t]}formatDate(e){return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}getFileIcon(e){switch(e.split(".").pop()?.toLowerCase()){case"html":case"htm":return"📄";case"css":return"🎨";case"js":case"ts":return"⚡";case"png":case"jpg":case"jpeg":case"gif":case"svg":return"🖼️";case"pdf":return"📋";case"txt":case"md":return"📝";default:return"📄"}}}const y=new Y,T=N("bucket",()=>{const l=v([]),e=v(!1),n=v(null),r=v(""),t=v(""),i=m(()=>r.value?l.value.filter(s=>s.key.toLowerCase().includes(r.value.toLowerCase())):l.value),p=m(()=>l.value.length),g=m(()=>l.value.reduce((s,a)=>s+a.size,0)),_=m(()=>y.formatFileSize(g.value));async function f(s=""){e.value=!0,n.value=null;try{const a=await y.listFiles(s);l.value=a.files,t.value=s}catch(a){n.value=a instanceof Error?a.message:"加载文件失败",console.error("加载文件失败:",a)}finally{e.value=!1}}async function S(){await f(t.value)}function $(s){r.value=s}function C(){n.value=null}function z(s){return y.getFileUrl(s)}function x(s){return y.formatFileSize(s)}function b(s){return y.formatDate(s)}function B(s){return y.getFileIcon(s)}return{files:l,loading:e,error:n,searchQuery:r,currentPrefix:t,filteredFiles:i,totalFiles:p,totalSize:g,formattedTotalSize:_,loadFiles:f,refreshFiles:S,setSearchQuery:$,clearError:C,getFileUrl:z,formatFileSize:x,formatDate:b,getFileIcon:B}}),X={class:"file-list"},ee={class:"search-bar"},te={class:"search-input-wrapper"},se={class:"stats-bar"},oe={class:"file-count"},ne={class:"total-size"},ae={key:0,class:"loading-container"},re={key:1,class:"error-container"},ie={class:"error-message"},ce={key:2,class:"files-container"},le={key:0,class:"empty-state"},ue={key:0},de={key:1},fe=["onClick"],pe={class:"file-icon"},he={class:"file-info"},ve={class:"file-name"},me={class:"file-details"},_e={class:"file-size"},ge={class:"file-date"},ye={class:"file-actions"},ke=["onClick"],be=["onClick"],Fe=F({__name:"BucketFileList",setup(l){const e=T(),n=v(""),r=m(()=>e.filteredFiles),t=m(()=>e.loading),i=m(()=>e.error),p=m(()=>e.formattedTotalSize);function g(){e.setSearchQuery(n.value)}function _(){n.value="",e.setSearchQuery("")}function f(){e.clearError(),e.refreshFiles()}function S(s){const a=s.split("/");return a[a.length-1]||s}function $(s){return e.getFileIcon(s)}function C(s){return e.formatFileSize(s)}function z(s){return e.formatDate(s)}function x(s){s.type==="folder"?console.log("点击文件夹:",s.key):b(s)}function b(s){const a=e.getFileUrl(s.key);window.open(a,"_blank")}function B(s){const a=e.getFileUrl(s.key);if(navigator.clipboard)navigator.clipboard.writeText(a).then(()=>{console.log("URL已复制到剪贴板")});else{const c=document.createElement("textarea");c.value=a,document.body.appendChild(c),c.select(),document.execCommand("copy"),document.body.removeChild(c),console.log("URL已复制到剪贴板")}}return(s,a)=>(d(),u("div",X,[o("div",ee,[o("div",te,[a[1]||(a[1]=o("span",{class:"search-icon"},"🔍",-1)),V(o("input",{"onUpdate:modelValue":a[0]||(a[0]=c=>n.value=c),type:"text",placeholder:"搜索文件...",class:"search-input",onInput:g},null,544),[[U,n.value]]),n.value?(d(),u("button",{key:0,onClick:_,class:"clear-search"}," ✕ ")):k("",!0)])]),o("div",se,[o("span",oe,h(r.value.length)+" 个文件",1),o("span",ne,"总大小: "+h(p.value),1)]),t.value?(d(),u("div",ae,[...a[2]||(a[2]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"加载中...",-1)])])):k("",!0),i.value?(d(),u("div",re,[a[3]||(a[3]=o("div",{class:"error-icon"},"⚠️",-1)),o("p",ie,h(i.value),1),o("button",{onClick:f,class:"retry-btn"},"重试")])):k("",!0),!t.value&&!i.value?(d(),u("div",ce,[r.value.length===0?(d(),u("div",le,[a[4]||(a[4]=o("div",{class:"empty-icon"},"📁",-1)),a[5]||(a[5]=o("h3",null,"没有找到文件",-1)),n.value?(d(),u("p",ue,"尝试修改搜索条件")):(d(),u("p",de,"存储桶中没有文件"))])):k("",!0),(d(!0),u(A,null,E(r.value,c=>(d(),u("div",{key:c.key,class:"file-item",onClick:M=>x(c)},[o("div",pe,h($(c.key)),1),o("div",he,[o("h4",ve,h(S(c.key)),1),o("div",me,[o("span",_e,h(C(c.size)),1),o("span",ge,h(z(c.lastModified)),1)])]),o("div",ye,[o("button",{onClick:D(M=>b(c),["stop"]),class:"action-btn"},h(c.type==="folder"?"📂":"👁️"),9,ke),o("button",{onClick:D(M=>B(c),["stop"]),class:"action-btn"}," 📋 ",8,be)])],8,fe))),128))])):k("",!0)]))}}),w=(l,e)=>{const n=l.__vccOpts||l;for(const[r,t]of e)n[r]=t;return n},we=w(Fe,[["__scopeId","data-v-76c6aea8"]]),Se={class:"bucket-view"},$e=F({__name:"BucketView",setup(l,{expose:e}){const n=T();return R(async()=>{await n.loadFiles()}),e({refresh:()=>n.refreshFiles()}),(r,t)=>(d(),u("div",Se,[I(we)]))}}),Ce=w($e,[["__scopeId","data-v-7e76070e"]]),ze=O({history:K("/"),routes:[{path:"/",name:"bucket",component:Ce},{path:"/:pathMatch(.*)*",redirect:"/"}]}),xe={class:"mobile-layout"},Be={class:"phone-frame"},Ie={class:"status-bar"},Le={class:"status-left"},Me={class:"time"},De={class:"app-header"},Re={class:"header-actions"},Te=["disabled"],Ne={class:"app-content"},Ve=F({__name:"MobileLayout",emits:["refresh"],setup(l,{emit:e}){const n=v(""),r=v(!1);let t=null;const i=e;function p(){const _=new Date;n.value=_.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}async function g(){r.value=!0,i("refresh"),setTimeout(()=>{r.value=!1},1e3)}return R(()=>{p(),t=setInterval(p,1e3)}),P(()=>{t&&clearInterval(t)}),(_,f)=>(d(),u("div",xe,[o("div",Be,[o("div",Ie,[o("div",Le,[o("span",Me,h(n.value),1)]),f[0]||(f[0]=Q('<div class="status-center" data-v-e5a55fa1><div class="notch" data-v-e5a55fa1></div></div><div class="status-right" data-v-e5a55fa1><span class="signal" data-v-e5a55fa1>📶</span><span class="wifi" data-v-e5a55fa1>📶</span><span class="battery" data-v-e5a55fa1>🔋</span></div>',2))]),o("header",De,[f[1]||(f[1]=o("h1",{class:"app-title"},"WWW存储桶",-1)),o("div",Re,[o("button",{onClick:g,class:"refresh-btn",disabled:r.value},[o("span",{class:Z(["refresh-icon",{spinning:r.value}])},"🔄",2)],8,Te)])]),o("main",Ne,[j(_.$slots,"default",{},void 0)]),f[2]||(f[2]=o("div",{class:"home-indicator"},null,-1))])]))}}),Ue=w(Ve,[["__scopeId","data-v-e5a55fa1"]]),Ae={id:"app"},Ee=F({__name:"App",setup(l){const e=v();function n(){e.value?.refresh&&e.value.refresh()}return(r,t)=>(d(),u("div",Ae,[I(Ue,{onRefresh:n},{default:W(()=>[I(q(G),{ref_key:"routerViewRef",ref:e},null,512)]),_:1})]))}}),Oe=w(Ee,[["__scopeId","data-v-93cb6843"]]),L=H(Oe);L.use(J());L.use(ze);L.mount("#app");
